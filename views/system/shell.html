{% extends 'system/systemtemplate.html' %}

{% block configpage %}
<script type="text/javascript">

function run_command() {  	
	$('#error').empty();
	$('#terminal').empty();
	var runcommand = $('#commandbox').attr('value');
	if (runcommand == "") {  
		$('#error').text(' Command box cannot be empty');
		$("input#commandbox").focus();  
		return false;  
	} 
	$('#runloader').show();
	$.ajax({
		type: "POST",
		url: "/api/runcommand",
		data: { command: runcommand },
		dataType : 'json',
		statusCode: {
			500: function() {
				$('#terminal').text("Server Error");
			}	
		},
		success: function(json){
			var result = json;
			if (result.success == true) {
				$('#runloader').hide();
				$.each(result.output, function(i,line){
					$('#terminal').append(line + "<br/>");
				}); 
			}
			else {
				$('#runloader').hide();
				$('#terminal').text("Command failed"); 
			}  
		}
	});
}
hide_loader();
</script>
<div id="configpage">
<h2>Shell</h2>

<div id="leftpanel">
<div id="header">
<div>Shell</div>
</div><!-- header -->
<div id="displayarea">
<img id="runloader" style="display:none;" src="/static/images/loader.gif"/>
<input type="button" name="runcommand" value="Run" id="runbutton" onclick="run_command();"/>
<form id="runcommand" action="" method="">
	
	<input type="text" name="command" id="commandbox"/>
	<br/><br/>
	<label for="commandbox" id="error"></label>
</form>
<br/>

<br/>
<div id="terminal"></div><!-- terminal -->
</div><!-- displayarea -->
</div><!-- leftpanel -->

</div><!-- configpage -->
{% endblock %}
